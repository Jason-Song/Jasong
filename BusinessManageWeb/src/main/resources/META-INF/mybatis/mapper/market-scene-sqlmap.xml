<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.good.market.mapper.SceneDao">

    <resultMap id="sceneMap" type="com.good.market.bean.ScenePo">
        <result property="id" column="ID"/>
        <result property="name" column="NAME"/>
        <result property="sceneDesc" column="SCENE_DESC"/>
        <result property="condName" column="COND_NAME"/>
        <result property="strategyName" column="STRATEGY_NAME"/>
        <result property="createUser" column="CREATE_USER"/>
        <result property="createTime" column="CREATE_TIME"/>
        <result property="lastUpdUser" column="LAST_UPD_USER"/>
        <result property="lastUpdTime" column="LAST_UPD_TIME"/>
    </resultMap>
        
    <select id="listScene" resultMap="sceneMap">
        select  T.ID			as id,
        		T.NAME   		as name,
        		T.SCENE_DESC 	as sceneDesc,
        		T.COND_NAME		as condName,
        		T.STRATEGY_NAME	as strategyName,
        		T.CREATE_USER  	as createUser,
        		CU.NAME			as crtUserName,
        		T.CREATE_TIME   as createTime,
        		T.LAST_UPD_USER as lastUpdUser,
        		UU.NAME			as updUserName,
        		T.LAST_UPD_TIME as lastUpdTime
        from T_SCENE T
        left join T_USER CU on T.CREATE_USER = CU.USERID
        left join T_USER UU on T.LAST_UPD_USER = UU.USERID
        <where>1=1
            <if test="condition.name != null and condition.name != ''"> and T.NAME = #{condition.name} </if>
            <if test="condition.sceneDesc != null and condition.sceneDesc != ''"> and T.SCENE_DESC like '%${condition.sceneDesc}%' </if>
            <if test="condition.condName != null and condition.condName != ''"> and T.COND_NAME  like ',%${condition.condName}%,' </if>
            <if test="condition.strategyName != null and condition.strategyName != ''"> and T.STRATEGY_NAME  like ',%${condition.strategyName}%,' </if>
            <if test="condition.createUser != null and condition.createUser != ''"> and T.CREATE_USER = #{condition.createUser} </if>
            <if test="condition.crtStartTime != null and condition.crtStartTime != ''"> and T.CREATE_TIME &gt;= #{condition.crtStartTime} </if>
            <if test="condition.crtEndTime != null and condition.crtEndTime != ''"> and T.CREATE_TIME &lt;= #{condition.crtEndTime} </if>
            <if test="condition.lastUpdUser != null and condition.lastUpdUser != ''"> and T.LAST_UPD_USER = #{condition.lastUpdUser} </if>            
            <if test="condition.updStartTime != null and condition.updStartTime != ''"> and T.LAST_UPD_TIME &gt;= #{condition.updStartTime} </if>
            <if test="condition.updEndTime != null and condition.updEndTime != ''"> and T.LAST_UPD_TIME &lt;= #{condition.updEndTime} </if>
        </where>
        <if test="condition.orders != null " > ORDER BY ${condition.orders}</if>
    </select>
    
	<insert id="insertScene" useGeneratedKeys="false" keyProperty="id" parameterType="com.good.market.bean.ScenePo" > 
        insert into T_SCENE (ID,NAME,SCENE_DESC,COND_NAME,STRATEGY_NAME,CREATE_USER,CREATE_TIME,LAST_UPD_USER,LAST_UPD_TIME)
        values(SEQ_T_SCENE.nextval ,#{name,jdbcType=VARCHAR},#{sceneDesc,jdbcType=VARCHAR},#{condName,jdbcType=VARCHAR},#{strategyName,jdbcType=VARCHAR},#{createUser,jdbcType=INTEGER},#{createTime,jdbcType=CHAR},#{lastUpdUser,jdbcType=INTEGER},#{lastUpdTime,jdbcType=CHAR})
    </insert>

</mapper>

